import{r as v,c as a,a as o,b as p,w as C,v as I,t as h,o as s,d as A,e as L,f as F,T as Q,F as x,g as N,n as D,h as w,i as k,j as E,k as T,l as G,m as U,p as M,q as V,s as q}from"./runtime-dom.esm-bundler.CrhLlqhy.js";const B="https://media.themoviedb.org/t/p/w600_and_h900_bestv2",O="abc",_=(l,e)=>{const n=l.__vccOpts||l;for(const[t,m]of e)n[t]=m;return n},R={name:"MovieCard",props:{movie:{type:Object,required:!0}},setup(){const l=v(!1);function e(){l.value=!0}function n(t){return`${B}${t}`}return{imageLoaded:l,onImageLoad:e,imageUrl:n}}},H=["id"],$={class:"relative select-none"},Y={key:0,class:"w-full h-full bg-zinc-700 animate-pulse rounded-lg"},W=["src","alt"],K={class:"absolute bottom-0 left-0 w-full px-6 pb-8 z-20 flex flex-col"},P={class:"text-xl font-semibold text-white drop-shadow-md"};function X(l,e,n,t,m,u){return s(),a("article",{id:`movie-card-${n.movie.id}`,class:"movie-card relative cursor-pointer hover:scale-105 transition-transform duration-300 aspect-[9/12]",onClick:e[1]||(e[1]=r=>l.$emit("select",n.movie))},[o("div",$,[t.imageLoaded?p("",!0):(s(),a("div",Y)),C(o("img",{src:t.imageUrl(n.movie.poster_path),alt:n.movie.title,width:"100",height:"150",class:"movie-card-image w-full h-auto rounded-lg shadow-lg object-cover",onLoad:e[0]||(e[0]=(...r)=>t.onImageLoad&&t.onImageLoad(...r))},null,40,W),[[I,t.imageLoaded]]),e[2]||(e[2]=o("div",{class:"absolute bottom-0 left-0 w-full h-1/2 rounded-b-lg bg-gradient-to-t from-black via-black/80 to-transparent z-10"},null,-1))]),o("div",K,[o("h2",P,h(n.movie.title),1)])],8,H)}const J=_(R,[["render",X]]);function Z(l){const e=Math.floor(l/60),n=l%60;return e>0&&n>0?`${e}h ${n} minutes`:e>0?`${e}h`:`${n} minutes`}function ee(l){const e=new Date(l),n={year:"numeric",month:"short"};return e.toLocaleDateString("en-US",n)}const te={name:"MovieModal",props:{movie:{type:Object,default:{}},fromElement:{type:[Object,null],default:null}},emits:["close"],setup(l){const e=v(l.movie),n=v(!1),t=v(""),m=v([]);function u(){n.value=!0}function r(){const d=document.querySelector(`#movie-card-${e.id}`),i=document.querySelector(`#movie-modal-${e.id}`);if(console.log({fromElement:d,currentElement:i}),!d||!i)return;const g=Flip.getState(d);Flip.from(g,{duration:.5,ease:"power2.inOut",absolute:!0,scale:!0}).play()}return A(()=>l.movie,d=>{n.value&&(n.value=!1),e.value=d,t.value=`api/images.json?path=${d?.poster_path}`,m.value=d?.genres.split(",").map(i=>i.trim())||[],d?.id&&r()},{immediate:!0}),{movie:e,imageUrl:t,genresList:m,formatDateToMonthYear:ee,formatRuntime:Z,imageLoaded:n,handleImageLoad:u,playAnimation:r}},methods:{handleClose(){this.$emit("close")}}},oe={key:0,class:"hidden lg:block w-full h-full fixed inset-0 z-40 bg-black/20"},ne=["id"],le={class:"background-blur-no-hover flex flex-col md:flex-row gap-6 lg:gap-8 w-full lg:w-auto h-full lg:h-auto p-4 lg:p-0 lg:pr-8 rounded-xl overflow-hidden relative"},ie={class:"lg:w-[450px] h-[45%] mx-auto lg:mx-none lg:h-full flex items-center justify-center relative aspect-[9/14]"},se={key:0,class:"w-full h-full absolute inset-0 flex items-center justify-center bg-zinc-100 dark:bg-zinc-800 animate-pulse rounded-lg"},ae=["src","alt"],re={class:"w-full md:w-2/3 lg:w-120 flex flex-col lg:py-6 h-full"},de={class:"flex flex-col mb-4"},ce={class:"text-5xl font-semibold mb-4 text-black dark:text-white"},ue={class:"text-base text-zinc-900 dark:text-zinc-200 mb-1"},me={class:"text-base text-zinc-900 dark:text-zinc-200"},ve={key:1,class:"text-xs px-2 py-0.5 rounded-md text-white bg-red-500"},fe={key:0,class:"flex flex-wrap gap-1.5"},he={class:"text-base text-zinc-900 dark:text-zinc-200 mt-2 mb-4 line-clamp-5 sm:line-clamp-6 md:line-clamp-none"},ge=["href"];function pe(l,e,n,t,m,u){return s(),a(x,null,[t.movie?.id?(s(),a("div",oe)):p("",!0),L(Q,{name:"modal"},{default:F(()=>[t.movie?.id?(s(),a("div",{key:0,id:`movie-modal-${t.movie.id}`,class:"fixed inset-0 z-50 flex items-center justify-center lg:p-4",onClick:e[2]||(e[2]=N((...r)=>u.handleClose&&u.handleClose(...r),["self"]))},[o("button",{class:"absolute top-4 right-5 z-70 size-5 text-black hover:text-zinc-800 dark:text-white dark:hover:text-zinc-200 cursor-pointer",onClick:e[0]||(e[0]=(...r)=>u.handleClose&&u.handleClose(...r))},e[3]||(e[3]=[o("svg",{class:"w-full h-full",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[o("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),o("path",{d:"M18 6l-12 12"}),o("path",{d:"M6 6l12 12"})],-1)])),o("div",le,[o("div",ie,[t.imageLoaded?p("",!0):(s(),a("div",se,e[4]||(e[4]=[o("div",{class:"w-full h-full bg-zinc-200 dark:bg-zinc-700 rounded-lg"},null,-1)]))),o("img",{src:t.imageUrl,alt:t.movie.title,width:"100",height:"100",class:"w-full h-full object-cover object-top lg:object-center aspect-auto rounded-lg lg:rounded-none",crossorigin:"anonymous",onLoad:e[1]||(e[1]=(...r)=>t.handleImageLoad&&t.handleImageLoad(...r)),style:D({visibility:t.imageLoaded?"visible":"hidden"})},null,44,ae)]),o("div",re,[o("div",de,[o("h2",ce,h(t.movie.title),1),o("h3",ue," Original title: "+h(t.movie.original_title),1),o("p",me,[String(t.movie.status).toLocaleLowerCase()==="released"?(s(),a(x,{key:0},[w(h(t.formatDateToMonthYear(t.movie.release_date)),1)],64)):(s(),a("span",ve,"Not released")),w("   •  "+h(t.formatRuntime(t.movie.runtime))+"   •  "+h(String(t.movie.original_language).toUpperCase()),1)])]),t.genresList.length>0?(s(),a("div",fe,[(s(!0),a(x,null,k(t.genresList,(r,d)=>(s(),a("span",{key:d+1,class:"text-sm text-zinc-900 dark:text-zinc-200 border border-zinc-600 dark:border-zinc-300 py-1 px-3 rounded-full"},h(r),1))),128))])):p("",!0),o("p",he,h(t.movie.overview),1),o("a",{href:`https://www.imdb.com/es/title/${t.movie.imdb_id}`,class:"w-fit"},e[5]||(e[5]=[o("img",{src:"/imdb-logo.svg",alt:"IMDb Logo",srcset:""},null,-1)]),8,ge)])])],8,ne)):p("",!0)]),_:1})],64)}const xe=_(te,[["render",pe]]),z={headers:{"X-Internal-Access":O}},be=["Action","Adventure","Animation","Comedy","Crime","Documentary","Drama","Family","Fantasy","History","Horror","Music","Mystery","Romance","Science Fiction","TV Movie","Thriller","War","Western"],we={name:"Movies",components:{MovieCard:J,MovieModal:xe},setup(){const l=v(!0),e=v([]),n=v(40),t=v(null),m=v(""),u=v([]),r=G(()=>u.value.join(",")),d=async()=>{e.length==0&&(l.value=!0);const c=await fetch(`/api/movies.json?pageSize=${n.value}${u.value.length>0?`&genres=${r.value}`:""}`,z);if(c.status!=200)return l.value=!1;e.value=await c.json(),l.value=!1},i=async()=>{const c=m.value;if(!c){await d();return}const f=await fetch(`/api/search.json?q=${encodeURIComponent(c)}&pageSize=${n.value}`,z);if(f.status!=200)return l.value=!1;e.value=await f.json()},g=async c=>{const f=c.target.value;f.trim()?(m.value=f,await i()):await d()},b=c=>{t.value=c},j=async()=>{const f=(Number(n.value)||0)+24;n.value=f,m.value&&m.value.trim()?await i():await d()},S=async c=>{y(c)?u.value=u.value.filter(f=>f!==c):u.value.push(c),await d()},y=c=>u.value.includes(c);return U(async()=>{await d()}),{loading:l,moviesList:e,moviesQuantity:n,movieGenres:be,onInput:g,selectedMovie:t,openMovieModal:b,searchQuery:m,incrementMoviesQuantity:j,handleGenreFilter:S,genreFilterString:r,isGenreActive:y}}},ke={id:"search",class:"w-full flex flex-col min-h-100"},_e={class:"w-full h-full max-w-100 mx-auto mb-6 flex justify-center select-none"},ye={class:"w-full flex flex-wrap justify-center gap-1.5 px-2 mb-8"},Me=["onClick"],ze={key:0,class:"size-3",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Ce={key:0,class:"flex flex-col w-full"},Le={key:0,class:"flex flex-col w-full gap-8"},je={class:"w-full grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},Se={class:"col-span-4 flex justify-center"},Ie=["disabled"],Ae={key:1,class:"flex justify-center w-full"},Fe={key:1,class:"w-full flex flex-col items-center min-h-80 py-10"};function Qe(l,e,n,t,m,u){const r=M("MovieCard"),d=M("MovieModal");return s(),a("section",ke,[o("div",_e,[C(o("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>t.searchQuery=i),onInput:e[1]||(e[1]=(...i)=>t.onInput&&t.onInput(...i)),placeholder:"Search a movie",class:"text-sm w-full px-4 py-3 rounded-lg background-blur border border-zinc-400/50 dark:border-zinc-700/50 transition-colors",autocomplete:"off"},null,544),[[E,t.searchQuery]])]),o("div",ye,[(s(!0),a(x,null,k(t.movieGenres,(i,g)=>(s(),a("button",{key:g+1,type:"button",onClick:b=>t.handleGenreFilter(i),class:V(`${t.isGenreActive(i)?"text-white bg-black dark:text-black dark:bg-white border-transparent pl-2 pr-1.5":"text-zinc-800 dark:text-zinc-200 border-zinc-400/50 dark:border-zinc-600/50 px-4"} flex items-center gap-1.5 cursor-pointer text-sm text-nowrap py-1 rounded-lg border transition-colors`)},[w(h(i)+" ",1),t.isGenreActive(i)?(s(),a("svg",ze,e[4]||(e[4]=[o("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),o("path",{d:"M18 6l-12 12"},null,-1),o("path",{d:"M6 6l12 12"},null,-1)]))):p("",!0)],10,Me))),128))]),t.loading?(s(),a("div",Fe,e[6]||(e[6]=[T('<svg class="animate-spin [animation-duration:1.5s] size-10" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 6l0 -3"></path><path d="M16.25 7.75l2.15 -2.15"></path><path d="M18 12l3 0"></path><path d="M16.25 16.25l2.15 2.15"></path><path d="M12 18l0 3"></path><path d="M7.75 16.25l-2.15 2.15"></path><path d="M6 12l-3 0"></path><path d="M7.75 7.75l-2.15 -2.15"></path></svg><p class="text-sm text-zinc-800 dark:text-zinc-200 mt-8">Loading movies</p>',2)]))):(s(),a("div",Ce,[t.moviesList.length>0?(s(),a("div",Le,[o("div",je,[(s(!0),a(x,null,k(t.moviesList,(i,g)=>(s(),q(r,{movie:i,key:i.id,onSelect:t.openMovieModal},null,8,["movie","onSelect"]))),128))]),o("div",Se,[o("button",{type:"button",class:"bg-black dark:bg-white dark:hover:bg-zinc-200 px-8 py-2.5 cursor-pointer text-base rounded-lg text-white dark:text-black font-medium select-none disabled:opacity-50 disabled:cursor-not-allowed",onClick:e[2]||(e[2]=(...i)=>t.incrementMoviesQuantity&&t.incrementMoviesQuantity(...i)),disabled:t.moviesQuantity>=1e5},"Load more",8,Ie)])])):(s(),a("div",Ae,e[5]||(e[5]=[o("p",{class:"text-sm text-zinc-800 dark:text-zinc-200 mt-8"},"No movies found",-1)])))])),L(d,{movie:t.selectedMovie,onClose:e[3]||(e[3]=i=>t.selectedMovie=null)},null,8,["movie"])])}const De=_(we,[["render",Qe]]);export{De as default};
